
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Black-Scholes Partial Differential Equation and the Finite Difference Method &#8212; FRE 6083: Quantitative Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"\\N": "\\mathbb{N}", "\\R": "\\mathbb{R}", "\\C": "\\mathbb{C}", "\\E": "\\mathbb{E}", "\\P": "\\mathbb{P}", "\\var": "\\text{var}", "\\cov": "\\text{cov}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/lecture12_black-scholes-pde-finite-difference';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="One Period Investment Models and Portfolio Optimization" href="lecture13_portfolio-optimization-discrete-time.html" />
    <link rel="prev" title="The Black-Scholes Lognormal Model via Formal Integration" href="lecture11_black-scholes-model.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">FRE 6083: Quantitative Methods</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture01_sequences-and-sums.html">Lecture 1: Sequences and Sums of Random Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture02_convergence-and-limits.html">Lecture 2: Convergence and Limit Theorems</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture03_markov-chains.html">Lecture 3: Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture04_poisson-process.html">Lecture 4: The Poisson Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture05_binomial-asset-pricing.html">Lecture 5: Binomial Asset Pricing Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture06_stochastic-processes.html">Lecture 6: Stochastic Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture07_brownian-motion.html">Lecture 7: Random Walk Limit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture09_brownian-motion.html">Lecture 9: Brownian Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture10_stochastic-calculus.html">Lecture 10: Stochastic Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture11_black-scholes-model.html">Lecture 11: Black-Scholes Model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 12: Black-Scholes PDE and Finite Difference</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture13_portfolio-optimization-discrete-time.html">Lecture 13: Portfolio Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture14_american-options-greeks.html">Lecture 14: American Options and Greeks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/duymlcoding/NYU_FRE_Notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/duymlcoding/NYU_FRE_Notes/edit/main/chapters/lecture12_black-scholes-pde-finite-difference.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/duymlcoding/NYU_FRE_Notes/issues/new?title=Issue%20on%20page%20%2Fchapters/lecture12_black-scholes-pde-finite-difference.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/lecture12_black-scholes-pde-finite-difference.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Black-Scholes Partial Differential Equation and the Finite Difference Method</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-finite-difference-methods">Introduction to Finite Difference Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization-of-time-and-space">Discretization of Time and Space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-discretization">Time Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#space-discretization">Space Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-computational-mesh">The Computational Mesh</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-heat-equation">The Heat Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-formulation">Problem Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-standard-explicit-scheme">The Standard Explicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-approximations">Finite Difference Approximations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consistency-analysis">Consistency Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-the-cfl-condition">Stability: The CFL Condition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-standard-implicit-scheme">The Standard Implicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulation">Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-black-scholes-merton-pde">The Black-Scholes-Merton PDE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#original-formulation">Original Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-of-time-variable">Change of Time Variable</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-degeneracy-log-transformation">Removing Degeneracy: Log Transformation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-condition-at-x-0">Boundary Condition at <span class="math notranslate nohighlight">\(x = 0\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-degenerate-boundary">Analysis of Degenerate Boundary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-scheme-for-black-scholes">Finite Difference Scheme for Black-Scholes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-and-notation">Mesh and Notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centered-difference-for-first-derivative">Centered Difference for First Derivative</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-order-term">Zero-Order Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-implicit-scheme">Complete Implicit Scheme</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-form-of-the-implicit-scheme">Matrix Form of the Implicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficient-values">Coefficient Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-equation">Matrix Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions-on-finite-domain">Boundary Conditions on Finite Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#truncated-domain">Truncated Domain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-values">Boundary Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interior-and-boundary-schemes">Interior and Boundary Schemes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-the-left-boundary-i-m-1">Handling the Left Boundary (<span class="math notranslate nohighlight">\(i = -M+1\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-the-right-boundary-i-m-1">Handling the Right Boundary (<span class="math notranslate nohighlight">\(i = M-1\)</span>)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recapitulation-complete-system">Recapitulation: Complete System</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-structure">Matrix Structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#right-hand-side-vector">Right-Hand Side Vector</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-guidelines">Implementation Guidelines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-algorithm">Complete Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tridiagonal-system-solver-in-matlab">Tridiagonal System Solver in MATLAB</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-black-scholes-partial-differential-equation-and-the-finite-difference-method">
<h1>The Black-Scholes Partial Differential Equation and the Finite Difference Method<a class="headerlink" href="#the-black-scholes-partial-differential-equation-and-the-finite-difference-method" title="Link to this heading">#</a></h1>
<p>This lecture introduces finite difference methods for solving the Black-Scholes partial differential equation. We begin with the heat equation, then extend to the Black-Scholes PDE for option pricing, covering discretization techniques, stability conditions, and practical implementation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>Recommended Reference:</strong></p>
<ul class="simple">
<li><p>J.W. Thomas, “Numerical Partial Differential Equations: Finite Difference Methods”, Texts in Applied Mathematics, 22, 1995, Springer</p></li>
</ul>
</div>
<section id="introduction-to-finite-difference-methods">
<h2>Introduction to Finite Difference Methods<a class="headerlink" href="#introduction-to-finite-difference-methods" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Key Properties of Finite Difference Methods:</strong></p>
<ul class="simple">
<li><p>Practical for 1, 2, or at most 3 spatial dimensions</p></li>
<li><p>Simple and easy to implement (with a learning curve to avoid pitfalls)</p></li>
<li><p>Accurate and robust when designed properly</p></li>
<li><p>Particularly suited for linear parabolic PDEs</p></li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Applications in Finance:</strong></p>
<p>Finite difference methods are widely used for pricing:</p>
<ul class="simple">
<li><p>European and American options</p></li>
<li><p>Exotic derivatives</p></li>
<li><p>Path-dependent options</p></li>
</ul>
<p>They provide a deterministic alternative to Monte Carlo simulation for low-dimensional problems.</p>
</div>
</section>
<section id="discretization-of-time-and-space">
<h2>Discretization of Time and Space<a class="headerlink" href="#discretization-of-time-and-space" title="Link to this heading">#</a></h2>
<section id="time-discretization">
<h3>Time Discretization<a class="headerlink" href="#time-discretization" title="Link to this heading">#</a></h3>
<p>We discretize the time interval <span class="math notranslate nohighlight">\([0, T]\)</span> into <span class="math notranslate nohighlight">\(N\)</span> subintervals.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Time Grid:</strong></p>
<ul class="simple">
<li><p>Time step: <span class="math notranslate nohighlight">\(\Delta t\)</span></p></li>
<li><p>Number of steps: <span class="math notranslate nohighlight">\(N\)</span> such that <span class="math notranslate nohighlight">\(N\Delta t = T\)</span></p></li>
<li><p>Discrete times: <span class="math notranslate nohighlight">\(\{0, \Delta t, 2\Delta t, \ldots, n\Delta t = T\}\)</span></p></li>
</ul>
<p><strong>Convergence:</strong> As <span class="math notranslate nohighlight">\(\Delta t \to 0\)</span> and <span class="math notranslate nohighlight">\(n \to +\infty\)</span>, the discrete grid converges to the continuous time interval <span class="math notranslate nohighlight">\([0, T]\)</span>.</p>
</div>
<p><strong>Physical Meaning:</strong> We approximate continuous time by sampling at regular intervals. Smaller time steps give better approximations but require more computation.</p>
</section>
<section id="space-discretization">
<h3>Space Discretization<a class="headerlink" href="#space-discretization" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Space Grid:</strong></p>
<ul class="simple">
<li><p>Mesh points: <span class="math notranslate nohighlight">\(\{x_i = i\Delta x \mid i \in \mathbb{Z}\}\)</span> where <span class="math notranslate nohighlight">\(\Delta x\)</span> is the mesh size</p></li>
<li><p>As <span class="math notranslate nohighlight">\(\Delta x \to 0\)</span>, the mesh converges to the whole real line</p></li>
</ul>
<p><strong>Approximation Quality:</strong> For <span class="math notranslate nohighlight">\(\Delta x\)</span> small enough, the mesh provides a good approximation of the real line.</p>
</div>
</section>
<section id="the-computational-mesh">
<h3>The Computational Mesh<a class="headerlink" href="#the-computational-mesh" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Complete Mesh:</strong></p>
<p>We work with the mesh:
$<span class="math notranslate nohighlight">\(
\{(n\Delta t, i\Delta x) \mid n = 0, \ldots, N; \, i \in \mathbb{Z}\}
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\((\Delta t, \Delta x)\)</span> are the discretization steps and <span class="math notranslate nohighlight">\(N\)</span> satisfies <span class="math notranslate nohighlight">\(N\Delta t = T\)</span>.</p>
</div>
<p><strong>Notation:</strong> We denote by <span class="math notranslate nohighlight">\(u_i^n\)</span> the approximation of the option value <span class="math notranslate nohighlight">\(u\)</span> at the grid point <span class="math notranslate nohighlight">\((n\Delta t, i\Delta x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
u(n\Delta t, i\Delta x) \approx u_i^n
\]</div>
<p><strong>Physical Meaning:</strong> Instead of knowing the option value at every point in continuous space-time, we compute it only at discrete grid points.</p>
</section>
</section>
<section id="the-heat-equation">
<h2>The Heat Equation<a class="headerlink" href="#the-heat-equation" title="Link to this heading">#</a></h2>
<section id="problem-formulation">
<h3>Problem Formulation<a class="headerlink" href="#problem-formulation" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Heat Equation (Linear Parabolic PDE):</strong></p>
<div class="math notranslate nohighlight">
\[
u_t(t, x) - u_{xx}(t, x) = 0 \quad \text{for } (t, x) \in (0, T] \times \mathbb{R}
\]</div>
<p><strong>Initial condition:</strong>
$<span class="math notranslate nohighlight">\(
u(0, x) = u_0(x)
\)</span>$</p>
<p><strong>Assumptions:</strong> <span class="math notranslate nohighlight">\(u_0\)</span> is continuous and bounded in <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p>
</div>
<p><strong>Physical Meaning:</strong> The heat equation models diffusion processes. In finance, it’s related to option pricing through variable transformations.</p>
</section>
<section id="notation">
<h3>Notation<a class="headerlink" href="#notation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Mesh:</strong> <span class="math notranslate nohighlight">\(\{(n\Delta t, i\Delta x) \mid n = 0, \ldots, N; \, i \in \mathbb{Z}\}\)</span> where <span class="math notranslate nohighlight">\(N\Delta t = T\)</span></p></li>
<li><p><strong>Approximation:</strong> <span class="math notranslate nohighlight">\(u_i^n\)</span> denotes the numerical solution on the mesh</p></li>
</ul>
</section>
</section>
<section id="the-standard-explicit-scheme">
<h2>The Standard Explicit Scheme<a class="headerlink" href="#the-standard-explicit-scheme" title="Link to this heading">#</a></h2>
<section id="finite-difference-approximations">
<h3>Finite Difference Approximations<a class="headerlink" href="#finite-difference-approximations" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Explicit Scheme for the Heat Equation:</strong></p>
<div class="math notranslate nohighlight">
\[
\frac{u_i^{n+1} - u_i^n}{\Delta t} - \frac{u_{i+1}^n + u_{i-1}^n - 2u_i^n}{\Delta x^2} = 0
\]</div>
<p><strong>Rearranged form:</strong>
$<span class="math notranslate nohighlight">\(
u_i^{n+1} = u_i^n + \Delta t \left\{\frac{u_{i+1}^n + u_{i-1}^n - 2u_i^n}{\Delta x^2}\right\}
\)</span>$</p>
<p><strong>Initial condition:</strong>
$<span class="math notranslate nohighlight">\(
u_i^0 = u_0(i\Delta x)
\)</span>$</p>
</div>
<p><strong>Physical Meaning:</strong> The scheme is “explicit” because we can directly compute <span class="math notranslate nohighlight">\(u_i^{n+1}\)</span> at time step <span class="math notranslate nohighlight">\(n+1\)</span> from known values at time step <span class="math notranslate nohighlight">\(n\)</span>, without solving a system of equations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Algorithm Simplicity:</strong></p>
<p>The explicit scheme is very easy to implement:</p>
<ol class="arabic simple">
<li><p>Initialize with discretized initial condition</p></li>
<li><p>For each time step, update each spatial point using the formula above</p></li>
<li><p>March forward in time</p></li>
</ol>
</div>
</section>
<section id="consistency-analysis">
<h3>Consistency Analysis<a class="headerlink" href="#consistency-analysis" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Truncation Error:</strong></p>
<p>The scheme is <strong>consistent</strong> with the continuous equation since the truncation error is:</p>
<ul class="simple">
<li><p><strong>Order 2 in space:</strong> <span class="math notranslate nohighlight">\(O(\Delta x^2)\)</span></p></li>
<li><p><strong>Order 1 in time:</strong> <span class="math notranslate nohighlight">\(O(\Delta t)\)</span></p></li>
</ul>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Derivation of Truncation Error</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Taylor expansion for spatial derivative:</strong></p>
<div class="math notranslate nohighlight">
\[
u_i^n(i+1) = u_i^n + u_x(n\Delta t, x_i)\Delta x + \frac{1}{2}u_{xx}(n\Delta t, x_i)\Delta x^2 + \frac{1}{6}u_{xxx}\Delta x^3 + \frac{1}{24}u_{xxxx}\Delta x^4 + \Delta x^4 \epsilon(\Delta x)
\]</div>
<div class="math notranslate nohighlight">
\[
u_{i-1}^n = u_i^n - u_x(n\Delta t, x_i)\Delta x + \frac{1}{2}u_{xx}(n\Delta t, x_i)\Delta x^2 - \frac{1}{6}u_{xxx}\Delta x^3 + \frac{1}{24}u_{xxxx}\Delta x^4 + \Delta x^4 \epsilon(\Delta x)
\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(\lim_{\Delta x \to 0} \epsilon(\Delta x) = 0\)</span>.</p>
<p class="sd-card-text"><strong>Adding the two expansions:</strong></p>
<div class="math notranslate nohighlight">
\[
\frac{u_{i+1}^n + u_{i-1}^n - 2u_i^n}{\Delta x^2} = u_{xx} + \frac{1}{12}u_{xxxx}\Delta x^2 + \Delta x^2 \epsilon(\Delta x)
\]</div>
<p class="sd-card-text">Thus, the truncation error for the second spatial derivative is <strong>order 2</strong>.</p>
<p class="sd-card-text"><strong>Taylor expansion for time derivative:</strong></p>
<div class="math notranslate nohighlight">
\[
u_i^{n+1} = u_i^n + u_t(n\Delta t, x_i)\Delta t + \frac{1}{2}u_{tt}(n\Delta t, x_i)\Delta t^2 + \Delta t^2 \epsilon(\Delta t)
\]</div>
<p class="sd-card-text">Therefore:
$<span class="math notranslate nohighlight">\(
\frac{u_i^{n+1} - u_i^n}{\Delta t} = u_t(n\Delta t, x_i) + \frac{1}{2}u_{tt}\Delta t + \Delta t \epsilon(\Delta t)
\)</span>$</p>
<p class="sd-card-text">The truncation error for the first time derivative is <strong>order 1</strong>.</p>
</div>
</details></section>
<section id="stability-the-cfl-condition">
<h3>Stability: The CFL Condition<a class="headerlink" href="#stability-the-cfl-condition" title="Link to this heading">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>CFL Condition (Courant-Friedrichs-Lewy):</strong></p>
<p>The explicit scheme is <strong>stable and convergent</strong> if and only if:</p>
<div class="math notranslate nohighlight">
\[
\left(1 + \frac{2\Delta t}{\Delta x^2}\right) \geq 0
\]</div>
<p><strong>Equivalent form:</strong>
$<span class="math notranslate nohighlight">\(
\Delta t \leq \frac{1}{2}\Delta x^2
\)</span>$</p>
<p><strong>Consequence:</strong> If this condition is violated, instabilities occur and the scheme does not converge.</p>
</div>
<p><strong>Physical Meaning:</strong> The time step must be small enough relative to the spatial step. This is a fundamental limitation of explicit schemes: very small time steps may be required, leading to high computational cost.</p>
</section>
</section>
<section id="the-standard-implicit-scheme">
<h2>The Standard Implicit Scheme<a class="headerlink" href="#the-standard-implicit-scheme" title="Link to this heading">#</a></h2>
<section id="motivation">
<h3>Motivation<a class="headerlink" href="#motivation" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Why Use Implicit Schemes?</strong></p>
<p>For many financial applications, the explicit scheme is very inaccurate because:</p>
<ul class="simple">
<li><p>The CFL condition forces the time step to be extremely small</p></li>
<li><p>Small time steps cause <strong>rounding errors</strong> to dominate the total computational error</p></li>
<li><p><strong>Total error = Truncation error + Rounding error</strong></p></li>
</ul>
<p>Most of the time, an implicit scheme is preferred because it is <strong>unconditionally convergent</strong>, regardless of time step size.</p>
</div>
</section>
<section id="formulation">
<h3>Formulation<a class="headerlink" href="#formulation" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Implicit Scheme for Heat Equation:</strong></p>
<p>The second derivative is evaluated at time <span class="math notranslate nohighlight">\((n+1)\Delta t\)</span> instead of <span class="math notranslate nohighlight">\(n\Delta t\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{u_i^{n+1} - u_i^n}{\Delta t} - \frac{u_{i+1}^{n+1} + u_{i-1}^{n+1} - 2u_i^{n+1}}{\Delta x^2} = 0
\]</div>
</div>
<p><strong>Physical Meaning:</strong> The scheme is “implicit” because <span class="math notranslate nohighlight">\(u_i^{n+1}\)</span> appears on both sides of the equation, requiring us to solve a system of equations at each time step.</p>
</section>
<section id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Key Implementation Steps:</strong></p>
<ol class="arabic simple">
<li><p>Convert the set of discrete implicit equations into a <strong>linear system</strong></p></li>
<li><p>Use an efficient solver (tridiagonal system solver)</p></li>
<li><p>The truncation errors are the same as for the explicit scheme</p></li>
<li><p>The implicit scheme is <strong>unconditionally stable</strong> for any choice of <span class="math notranslate nohighlight">\((\Delta t, \Delta x)\)</span></p></li>
</ol>
</div>
<p><strong>Physical Meaning:</strong> We trade computational simplicity (no longer just plug-and-chug) for stability (can take larger time steps).</p>
</section>
</section>
<section id="the-black-scholes-merton-pde">
<h2>The Black-Scholes-Merton PDE<a class="headerlink" href="#the-black-scholes-merton-pde" title="Link to this heading">#</a></h2>
<section id="original-formulation">
<h3>Original Formulation<a class="headerlink" href="#original-formulation" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Black-Scholes PDE for European Call:</strong></p>
<p>The price <span class="math notranslate nohighlight">\(u(t, x)\)</span> of a European call option satisfies:</p>
<div class="math notranslate nohighlight">
\[
u_t + ru - \frac{1}{2}\sigma^2 x^2 u_{xx} - rx u_x = 0, \quad \text{in } [0, T) \times [0, +\infty)
\]</div>
<p><strong>Terminal condition:</strong>
$<span class="math notranslate nohighlight">\(
u(T, x) = (x - K)^+
\)</span>$</p>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span> = risk-free interest rate</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> = volatility</p></li>
<li><p><span class="math notranslate nohighlight">\(K\)</span> = strike price</p></li>
<li><p><span class="math notranslate nohighlight">\(x\)</span> = stock price</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Solution Properties:</strong></p>
<p>The solution is:</p>
<ul class="simple">
<li><p>No longer bounded</p></li>
<li><p>Non-negative</p></li>
<li><p>Grows at most linearly for large values of <span class="math notranslate nohighlight">\(x\)</span></p></li>
</ul>
<p>The general framework needs only slight modification to accommodate linear growth at infinity.</p>
</div>
</section>
<section id="change-of-time-variable">
<h3>Change of Time Variable<a class="headerlink" href="#change-of-time-variable" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Backward Time Variable:</strong></p>
<p>We make the change of variable <span class="math notranslate nohighlight">\(\tau = T - t\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> = time to expiration</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span> = real time</p></li>
</ul>
<p>Define the new function:
$<span class="math notranslate nohighlight">\(
v(\tau, x) = u(t, x)
\)</span>$</p>
<p><strong>Derivatives:</strong>
$<span class="math notranslate nohighlight">\(
u_t = -v_\tau, \quad u_x = v_x, \quad u_{xx} = v_{xx}
\)</span>$</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Derivation of PDE for <span class="math notranslate nohighlight">\(v\)</span></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Substituting derivatives into the Black-Scholes PDE:</p>
<div class="math notranslate nohighlight">
\[
-v_\tau + rv - \frac{1}{2}\sigma^2 x^2 v_{xx} - rx v_x = 0
\]</div>
<p class="sd-card-text"><strong>Rearranged:</strong>
$<span class="math notranslate nohighlight">\(
v_\tau + rv - \frac{1}{2}\sigma^2 x^2 v_{xx} - rx v_x = 0, \quad \text{in } (0, T] \times [0, +\infty)
\)</span>$</p>
<p class="sd-card-text"><strong>Initial condition:</strong>
$<span class="math notranslate nohighlight">\(
v(0, x) = (x - K)^+
\)</span>$</p>
</div>
</details><p><strong>Physical Meaning:</strong> This change converts the terminal condition into an initial condition, which is more natural for finite difference schemes that march forward in time.</p>
</section>
<section id="removing-degeneracy-log-transformation">
<h3>Removing Degeneracy: Log Transformation<a class="headerlink" href="#removing-degeneracy-log-transformation" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Issue with Degeneracy:</strong></p>
<p>The Black-Scholes PDE is <strong>degenerate</strong> at <span class="math notranslate nohighlight">\(x = 0\)</span> because the second derivative term vanishes when <span class="math notranslate nohighlight">\(x = 0\)</span>. This makes the equation difficult to handle mathematically.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Change of Variable:</strong></p>
<p>Make the change of variable <span class="math notranslate nohighlight">\(y = \log x\)</span> and define:
$<span class="math notranslate nohighlight">\(
w(\tau, y) = v(\tau, x)
\)</span>$</p>
<p><strong>Derivatives:</strong>
$<span class="math notranslate nohighlight">\(
v_\tau = w_\tau, \quad v_x = w_y \frac{1}{x}, \quad v_{xx} = w_{yy}\frac{1}{x^2} + w_y\left(-\frac{1}{x^2}\right)
\)</span>$</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Derivation of PDE for <span class="math notranslate nohighlight">\(w\)</span></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Substituting into the PDE for <span class="math notranslate nohighlight">\(v\)</span>:</p>
<div class="math notranslate nohighlight">
\[
w_\tau + rw - \frac{1}{2}\sigma^2 w_{yy} - \left(r - \frac{1}{2}\sigma^2\right)w_y = 0, \quad \text{in } (0, T] \times \mathbb{R}
\]</div>
<p class="sd-card-text"><strong>Initial condition:</strong>
$<span class="math notranslate nohighlight">\(
w(0, y) = (e^y - K)^+
\)</span>$</p>
</div>
</details><p><strong>Physical Meaning:</strong> Working in log-price space removes the degeneracy and makes the PDE uniformly parabolic. This is analogous to working with log-returns in empirical finance.</p>
</section>
</section>
<section id="boundary-condition-at-x-0">
<h2>Boundary Condition at <span class="math notranslate nohighlight">\(x = 0\)</span><a class="headerlink" href="#boundary-condition-at-x-0" title="Link to this heading">#</a></h2>
<section id="analysis-of-degenerate-boundary">
<h3>Analysis of Degenerate Boundary<a class="headerlink" href="#analysis-of-degenerate-boundary" title="Link to this heading">#</a></h3>
<div class="tip admonition">
<p class="admonition-title">What Happens at <span class="math notranslate nohighlight">\(x = 0\)</span>?</p>
<p>We study the behavior of the solution at <span class="math notranslate nohighlight">\(x = 0\)</span> (equivalently, <span class="math notranslate nohighlight">\(y \to -\infty\)</span>).</p>
<p><strong>Key Result:</strong> The Black-Scholes PDE actually holds at <span class="math notranslate nohighlight">\(x = 0\)</span> and can be solved explicitly.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Derivation of Boundary Condition</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Plugging <span class="math notranslate nohighlight">\(x = 0\)</span> into the original Black-Scholes PDE:</p>
<div class="math notranslate nohighlight">
\[
u_t(t, 0) = -ru(t, 0)
\]</div>
<p class="sd-card-text">This is an <strong>ODE</strong> with terminal condition <span class="math notranslate nohighlight">\(u(T, 0)\)</span>.</p>
<p class="sd-card-text"><strong>Solution:</strong>
$<span class="math notranslate nohighlight">\(
u(t, 0) = e^{-r(T-t)} u(T, 0)
\)</span>$</p>
<p class="sd-card-text">Since <span class="math notranslate nohighlight">\(u(T, 0) = (0 - K)^+ = 0\)</span>, we have:
$<span class="math notranslate nohighlight">\(
u(t, 0) = 0
\)</span>$</p>
</div>
</details><div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Boundary Condition:</strong></p>
<p>At the left boundary (<span class="math notranslate nohighlight">\(x = 0\)</span> or <span class="math notranslate nohighlight">\(y = -R\)</span>):
$<span class="math notranslate nohighlight">\(
w(\tau, -R) \approx 0
\)</span>$</p>
</div>
<p><strong>Physical Meaning:</strong> A call option with zero stock price is worthless, both at maturity and before.</p>
</section>
</section>
<section id="finite-difference-scheme-for-black-scholes">
<h2>Finite Difference Scheme for Black-Scholes<a class="headerlink" href="#finite-difference-scheme-for-black-scholes" title="Link to this heading">#</a></h2>
<section id="mesh-and-notation">
<h3>Mesh and Notation<a class="headerlink" href="#mesh-and-notation" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Mesh Definition:</strong></p>
<div class="math notranslate nohighlight">
\[
\{(\tau_n, y_i) \mid n = 0, \ldots, N; \, i \in \mathbb{Z}\}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> is such that <span class="math notranslate nohighlight">\(N\Delta\tau = T\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_n = n\Delta\tau\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_i = i\Delta y\)</span></p></li>
</ul>
</div>
<p><strong>Approximation:</strong> We use <span class="math notranslate nohighlight">\(u_i^n\)</span> for the approximation of <span class="math notranslate nohighlight">\(w(\tau_n, y_i)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
w(n\Delta\tau, y_i) \approx u_i^n
\]</div>
</section>
<section id="centered-difference-for-first-derivative">
<h3>Centered Difference for First Derivative<a class="headerlink" href="#centered-difference-for-first-derivative" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Centered Finite Difference:</strong></p>
<div class="math notranslate nohighlight">
\[
-\left(r - \frac{1}{2}\sigma^2\right)w_y \approx -\left(r - \frac{1}{2}\sigma^2\right)\frac{u_{i+1}^{n+1} - u_{i-1}^{n+1}}{2\Delta y}
\]</div>
<p><strong>Truncation Error:</strong> Order 2 in space (better than left- or right-sided differences, which are order 1).</p>
</div>
<p><strong>Physical Meaning:</strong> The centered difference uses information from both sides of the point, leading to better accuracy.</p>
</section>
<section id="zero-order-term">
<h3>Zero-Order Term<a class="headerlink" href="#zero-order-term" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Implicit Evaluation:</strong></p>
<div class="math notranslate nohighlight">
\[
rw(\tau, y) \approx r u_i^{n+1}
\]</div>
</div>
</section>
<section id="complete-implicit-scheme">
<h3>Complete Implicit Scheme<a class="headerlink" href="#complete-implicit-scheme" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Implicit Scheme for Black-Scholes:</strong></p>
<div class="math notranslate nohighlight">
\[
\frac{u_i^{n+1} - u_i^n}{\Delta\tau} + r u_i^{n+1} - \frac{1}{2}\sigma^2 \frac{u_{i+1}^{n+1} + u_{i-1}^{n+1} - 2u_i^{n+1}}{\Delta y^2} - \left(r - \frac{1}{2}\sigma^2\right)\frac{u_{i+1}^{n+1} - u_{i-1}^{n+1}}{2\Delta y} = 0
\]</div>
<p><strong>Initial condition:</strong>
$<span class="math notranslate nohighlight">\(
u_i^0 = (e^{y_i} - K)^+
\)</span>$</p>
<p><strong>Stability:</strong> The scheme is <strong>unconditionally stable</strong> and hence convergent for every arbitrary pair <span class="math notranslate nohighlight">\((\Delta\tau, \Delta y)\)</span>.</p>
</div>
<p><strong>Physical Meaning:</strong> Being fully implicit, the scheme is stable for any time step size, allowing us to balance accuracy and computational efficiency.</p>
</section>
</section>
<section id="matrix-form-of-the-implicit-scheme">
<h2>Matrix Form of the Implicit Scheme<a class="headerlink" href="#matrix-form-of-the-implicit-scheme" title="Link to this heading">#</a></h2>
<section id="definitions">
<h3>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(h = (\Delta\tau, \Delta y)\)</span> and define:</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Vector and Matrix Notation:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{u}_h^n = \begin{bmatrix}
\vdots \\
u_{i-1}^n \\
u_i^n \\
u_{i+1}^n \\
\vdots
\end{bmatrix}, \quad A_h = \begin{bmatrix}
\ddots &amp; \ddots &amp; \ddots \\
\cdots &amp; a &amp; b &amp; c &amp; \cdots \\
\ddots &amp; \ddots &amp; \ddots
\end{bmatrix}
\end{split}\]</div>
<p>where the matrix <span class="math notranslate nohighlight">\(A_h\)</span> is <strong>tridiagonal</strong>.</p>
</div>
</section>
<section id="coefficient-values">
<h3>Coefficient Values<a class="headerlink" href="#coefficient-values" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Tridiagonal Coefficients:</strong></p>
<div class="math notranslate nohighlight">
\[
a = -\frac{1}{2}\sigma^2\frac{\Delta\tau}{\Delta y^2} + \left(r - \frac{1}{2}\sigma^2\right)\frac{\Delta\tau}{2\Delta y}
\]</div>
<div class="math notranslate nohighlight">
\[
b = 1 + \left(r\Delta\tau + \frac{\sigma^2\Delta\tau}{\Delta y^2}\right)
\]</div>
<div class="math notranslate nohighlight">
\[
c = -\left(r - \frac{1}{2}\sigma^2\right)\frac{\Delta\tau}{2\Delta y} - \frac{1}{2}\sigma^2\frac{\Delta\tau}{\Delta y^2}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span> = coefficient of <span class="math notranslate nohighlight">\(u_{i-1}^{n+1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> = coefficient of <span class="math notranslate nohighlight">\(u_i^{n+1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> = coefficient of <span class="math notranslate nohighlight">\(u_{i+1}^{n+1}\)</span></p></li>
</ul>
</div>
</section>
<section id="matrix-equation">
<h3>Matrix Equation<a class="headerlink" href="#matrix-equation" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Matrix Form:</strong></p>
<div class="math notranslate nohighlight">
\[
A_h \mathbf{u}_h^{n+1} = \mathbf{u}_h^n
\]</div>
<p><strong>Solution:</strong>
$<span class="math notranslate nohighlight">\(
\mathbf{u}_h^{n+1} = A_h^{-1} \mathbf{u}_h^n
\)</span>$</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Efficient Solution Required:</strong></p>
<p>Since <span class="math notranslate nohighlight">\(A_h\)</span> is <strong>tridiagonal</strong>, solving the system can be done efficiently and accurately using a specialized tridiagonal solver.</p>
<p><strong>Never:</strong></p>
<ul class="simple">
<li><p>Use a general matrix inversion</p></li>
<li><p>Use MATLAB’s <code class="docutils literal notranslate"><span class="pre">inv</span></code> operator (too slow and inaccurate)</p></li>
</ul>
<p><strong>Do:</strong></p>
<ul class="simple">
<li><p>Use a tridiagonal system solver</p></li>
<li><p>In MATLAB, use the backslash operator <code class="docutils literal notranslate"><span class="pre">\</span></code> (recognizes tridiagonal structure)</p></li>
</ul>
</div>
<p><strong>Physical Meaning:</strong> The tridiagonal structure means each spatial point only directly couples to its immediate neighbors, making the system very efficient to solve.</p>
</section>
</section>
<section id="boundary-conditions-on-finite-domain">
<h2>Boundary Conditions on Finite Domain<a class="headerlink" href="#boundary-conditions-on-finite-domain" title="Link to this heading">#</a></h2>
<section id="truncated-domain">
<h3>Truncated Domain<a class="headerlink" href="#truncated-domain" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Practical Consideration:</strong></p>
<p>In practice, we work on a bounded domain <span class="math notranslate nohighlight">\([-R, R]\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is large enough.</p>
<p><strong>New Mesh:</strong>
$<span class="math notranslate nohighlight">\(
\{(\tau_n, y_i) \mid n = 0, \ldots, N; \, i = -M, \ldots, M\}
\)</span>$</p>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\Delta\tau = T\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(M\Delta y = R\)</span></p></li>
</ul>
</div>
</section>
<section id="boundary-values">
<h3>Boundary Values<a class="headerlink" href="#boundary-values" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Boundary Conditions:</strong></p>
<p><strong>At <span class="math notranslate nohighlight">\(y = -R\)</span> (left boundary, <span class="math notranslate nohighlight">\(x \approx 0\)</span>):</strong>
$<span class="math notranslate nohighlight">\(
w(\tau, -R) \approx 0
\)</span>$</p>
<p><strong>At <span class="math notranslate nohighlight">\(y = R\)</span> (right boundary, <span class="math notranslate nohighlight">\(x \to \infty\)</span>):</strong>
$<span class="math notranslate nohighlight">\(
w(\tau, R) \approx e^R - e^{-r\tau}K
\)</span>$</p>
<p>This corresponds to the deep in-the-money call value.</p>
</div>
<p><strong>Physical Meaning:</strong></p>
<ul class="simple">
<li><p>Left boundary: worthless option when stock price near zero</p></li>
<li><p>Right boundary: option behaves like stock minus discounted strike when deep in-the-money</p></li>
</ul>
</section>
<section id="interior-and-boundary-schemes">
<h3>Interior and Boundary Schemes<a class="headerlink" href="#interior-and-boundary-schemes" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Scheme Applicability:</strong></p>
<ul class="simple">
<li><p>The general scheme holds for <strong>interior points</strong>: <span class="math notranslate nohighlight">\(i = -M+1, \ldots, M-1\)</span></p></li>
<li><p>At boundary points <span class="math notranslate nohighlight">\(i = -M\)</span> and <span class="math notranslate nohighlight">\(i = M\)</span>, we need special treatment</p></li>
</ul>
</div>
</section>
<section id="handling-the-left-boundary-i-m-1">
<h3>Handling the Left Boundary (<span class="math notranslate nohighlight">\(i = -M+1\)</span>)<a class="headerlink" href="#handling-the-left-boundary-i-m-1" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Left Boundary Treatment:</strong></p>
<p>For <span class="math notranslate nohighlight">\(i = -M+1\)</span>, the scheme includes <span class="math notranslate nohighlight">\(u_{-M}^{n+1}\)</span>, multiplied by coefficient <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p><strong>Solution:</strong> We can safely ignore <span class="math notranslate nohighlight">\(u_{-M}^n\)</span> in the scheme since <span class="math notranslate nohighlight">\(u_{-M}^n = 0\)</span> by the boundary condition.</p>
<p>The first row of matrix <span class="math notranslate nohighlight">\(A_h\)</span> has only 2 coefficients (coefficient <span class="math notranslate nohighlight">\(a\)</span> is missing, but it would multiply zero anyway).</p>
</div>
</section>
<section id="handling-the-right-boundary-i-m-1">
<h3>Handling the Right Boundary (<span class="math notranslate nohighlight">\(i = M-1\)</span>)<a class="headerlink" href="#handling-the-right-boundary-i-m-1" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Right Boundary Treatment:</strong></p>
<p>We must impose:
$<span class="math notranslate nohighlight">\(
u_M^n = e^{M\Delta y} - e^{-r(n\Delta\tau)}K
\)</span>$</p>
<p>For <span class="math notranslate nohighlight">\(i = M-1\)</span>, coefficient <span class="math notranslate nohighlight">\(c\)</span> is missing in the last row of <span class="math notranslate nohighlight">\(A_h\)</span>. This coefficient would multiply <span class="math notranslate nohighlight">\(u_M^n\)</span>.</p>
<p><strong>Solution:</strong> Incorporate the Dirichlet condition in the <strong>right-hand side</strong>.</p>
<p>The last component of the right-hand side becomes:
$<span class="math notranslate nohighlight">\(
u_{M-1}^n + \left\{-\frac{1}{2}\sigma^2\frac{\Delta\tau}{\Delta y^2} + \left(r - \frac{1}{2}\sigma^2\right)\frac{\Delta\tau}{2\Delta y}\right\}\left(e^{M\Delta y} - e^{-r((n+1)\Delta\tau)}K\right)
\)</span>$</p>
</div>
<p><strong>Physical Meaning:</strong> We build the known boundary value into the system, converting a constraint into part of the right-hand side vector.</p>
</section>
</section>
<section id="recapitulation-complete-system">
<h2>Recapitulation: Complete System<a class="headerlink" href="#recapitulation-complete-system" title="Link to this heading">#</a></h2>
<section id="matrix-structure">
<h3>Matrix Structure<a class="headerlink" href="#matrix-structure" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Tridiagonal System:</strong></p>
<p>We solve:
$<span class="math notranslate nohighlight">\(
A_h \mathbf{u}_h^{n+1} = \mathbf{B}_h^n
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(A_h\)</span> is a <span class="math notranslate nohighlight">\((2M-1) \times (2M-1)\)</span> matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A_h = \begin{bmatrix}
b &amp; c &amp; &amp; &amp; \\
a &amp; b &amp; c &amp; &amp; \\
&amp; \ddots &amp; \ddots &amp; \ddots &amp; \\
&amp; &amp; a &amp; b &amp; c \\
&amp; &amp; &amp; a &amp; b
\end{bmatrix}
\end{split}\]</div>
</div>
</section>
<section id="right-hand-side-vector">
<h3>Right-Hand Side Vector<a class="headerlink" href="#right-hand-side-vector" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Modified Right-Hand Side:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{B}_h^n = \begin{bmatrix}
u_{-M+1}^n \\
\vdots \\
u_{i-1}^n \\
u_i^n \\
u_{i+1}^n \\
\vdots \\
u_{M-2}^n \\
u_{M-1}^n - c(e^{M\Delta y} - e^{-r((n+1)\Delta\tau)}K)
\end{bmatrix}
\end{split}\]</div>
<p><strong>Note:</strong> The last entry is modified to incorporate the right boundary condition.</p>
</div>
</section>
</section>
<section id="implementation-guidelines">
<h2>Implementation Guidelines<a class="headerlink" href="#implementation-guidelines" title="Link to this heading">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Critical Implementation Notes:</strong></p>
<ol class="arabic simple">
<li><p><strong>Use a tridiagonal solver:</strong> Don’t create and invert a full matrix</p></li>
<li><p><strong>Memory efficiency:</strong> Define 3 vectors for coefficients <span class="math notranslate nohighlight">\((a, b, c)\)</span> rather than a full <span class="math notranslate nohighlight">\((2M-1) \times (2M-1)\)</span> matrix</p></li>
<li><p><strong>MATLAB backslash operator:</strong> Can use <code class="docutils literal notranslate"><span class="pre">\</span></code>, but:</p>
<ul class="simple">
<li><p>Requires creating a sparse matrix</p></li>
<li><p>Consumes more memory than 3 vectors</p></li>
<li><p>Still better than <code class="docutils literal notranslate"><span class="pre">inv</span></code> operator</p></li>
</ul>
</li>
<li><p><strong>Never use <code class="docutils literal notranslate"><span class="pre">inv</span></code> operator:</strong> Too slow and potentially inaccurate</p></li>
</ol>
</div>
<p><strong>Physical Meaning:</strong> Efficient implementation is crucial because we solve this linear system many times (once per time step).</p>
</section>
<section id="complete-algorithm">
<h2>Complete Algorithm<a class="headerlink" href="#complete-algorithm" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Step-by-Step Algorithm</p>
<p><strong>Step 1: Set Parameters</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T, K, r, \sigma\)</span> (option parameters)</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta\tau, \Delta y\)</span> (discretization steps)</p></li>
<li><p><span class="math notranslate nohighlight">\(N, M\)</span> (integers for grid size)</p></li>
</ul>
<p><strong>Step 2: Define Matrix Diagonals</strong></p>
<ul class="simple">
<li><p>Define vectors <span class="math notranslate nohighlight">\(\mathbf{a}, \mathbf{b}, \mathbf{c}\)</span> (or full matrix <span class="math notranslate nohighlight">\(A_h\)</span>)</p></li>
</ul>
<p><strong>Step 3: Initialize</strong>
$<span class="math notranslate nohighlight">\(
u_i^0 = (e^{i\Delta y} - K)^+, \quad \text{for } i = -M, \ldots, M
\)</span>$</p>
<p><strong>Step 4: Time Loop</strong></p>
<p>For <span class="math notranslate nohighlight">\(n = 0, \ldots, N-1\)</span>:</p>
<p>4.1. Define <span class="math notranslate nohighlight">\(\mathbf{B}_h^n\)</span> (right-hand side)</p>
<p>4.2. Given <span class="math notranslate nohighlight">\((u_i^n)_{i=-M}^M\)</span>, solve:
$<span class="math notranslate nohighlight">\(
A_h \mathbf{u}_h^{n+1} = \mathbf{B}_h^n
\)</span><span class="math notranslate nohighlight">\(
to compute \)</span>u_i^{n+1}<span class="math notranslate nohighlight">\( for \)</span>i = -M+1, \ldots, M-1$</p>
<p>4.3. Set boundary values:
$<span class="math notranslate nohighlight">\(
u_{-M}^{n+1} = 0, \quad u_M^{n+1} = e^{M\Delta y} - e^{-r((n+1)\Delta\tau)}K
\)</span>$</p>
<p><strong>Step 5: Extract Solution</strong></p>
<ul class="simple">
<li><p>Option price at time 0: <span class="math notranslate nohighlight">\(u_0^N\)</span> (at <span class="math notranslate nohighlight">\(y = 0\)</span>, i.e., <span class="math notranslate nohighlight">\(x = K\)</span>)</p></li>
</ul>
</div>
</section>
<section id="tridiagonal-system-solver-in-matlab">
<h2>Tridiagonal System Solver in MATLAB<a class="headerlink" href="#tridiagonal-system-solver-in-matlab" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MATLAB Implementation:</strong></p>
<p>The following function efficiently solves tridiagonal systems.</p>
</div>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>x<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">TDMAsolver</span><span class="p">(</span>a, b, c, d<span class="p">)</span>
<span class="c">% a, b, c are column vectors for the compressed tridiagonal matrix</span>
<span class="c">% d is the right-hand side vector</span>
<span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">d</span><span class="p">);</span><span class="w"> </span><span class="c">% n is the number of rows</span>

<span class="c">% Modify the first-row coefficients</span>
<span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% Division by zero risk</span>
<span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span><span class="n">temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="w">    </span><span class="n">d</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="k">end</span>

<span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>

<span class="c">% Back substitution</span>
<span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Algorithm Complexity:</strong></p>
<p>The Thomas algorithm (TDMA) solves a tridiagonal system in <span class="math notranslate nohighlight">\(O(n)\)</span> operations, compared to <span class="math notranslate nohighlight">\(O(n^3)\)</span> for general Gaussian elimination. This efficiency is crucial for real-time pricing.</p>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this lecture, we covered:</p>
<ol class="arabic simple">
<li><p><strong>Finite Difference Fundamentals:</strong></p>
<ul class="simple">
<li><p>Discretization of time and space</p></li>
<li><p>Explicit vs. implicit schemes</p></li>
<li><p>Stability and the CFL condition</p></li>
</ul>
</li>
<li><p><strong>Heat Equation:</strong></p>
<ul class="simple">
<li><p>Standard explicit and implicit schemes</p></li>
<li><p>Consistency and truncation error analysis</p></li>
</ul>
</li>
<li><p><strong>Black-Scholes PDE:</strong></p>
<ul class="simple">
<li><p>Change of variables (backward time and log-price)</p></li>
<li><p>Removal of degeneracy</p></li>
<li><p>Boundary conditions</p></li>
</ul>
</li>
<li><p><strong>Numerical Implementation:</strong></p>
<ul class="simple">
<li><p>Matrix formulation</p></li>
<li><p>Tridiagonal system structure</p></li>
<li><p>Efficient solution methods</p></li>
<li><p>Complete algorithm</p></li>
</ul>
</li>
<li><p><strong>Practical Considerations:</strong></p>
<ul class="simple">
<li><p>Boundary condition treatment</p></li>
<li><p>Memory-efficient implementation</p></li>
<li><p>MATLAB code for tridiagonal solver</p></li>
</ul>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Key Takeaway:</strong></p>
<p>Finite difference methods provide a powerful framework for pricing options numerically. The implicit scheme’s unconditional stability makes it the method of choice for many financial applications, despite requiring solution of linear systems at each time step.</p>
</div>
</section>
<hr class="docutils" />
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>J.W. Thomas, “Numerical Partial Differential Equations: Finite Difference Methods”, Texts in Applied Mathematics, 22, 1995, Springer</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture11_black-scholes-model.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Black-Scholes Lognormal Model via Formal Integration</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture13_portfolio-optimization-discrete-time.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">One Period Investment Models and Portfolio Optimization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-finite-difference-methods">Introduction to Finite Difference Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization-of-time-and-space">Discretization of Time and Space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-discretization">Time Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#space-discretization">Space Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-computational-mesh">The Computational Mesh</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-heat-equation">The Heat Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-formulation">Problem Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-standard-explicit-scheme">The Standard Explicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-approximations">Finite Difference Approximations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consistency-analysis">Consistency Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-the-cfl-condition">Stability: The CFL Condition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-standard-implicit-scheme">The Standard Implicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulation">Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-black-scholes-merton-pde">The Black-Scholes-Merton PDE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#original-formulation">Original Formulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-of-time-variable">Change of Time Variable</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-degeneracy-log-transformation">Removing Degeneracy: Log Transformation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-condition-at-x-0">Boundary Condition at <span class="math notranslate nohighlight">\(x = 0\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-degenerate-boundary">Analysis of Degenerate Boundary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-scheme-for-black-scholes">Finite Difference Scheme for Black-Scholes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-and-notation">Mesh and Notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centered-difference-for-first-derivative">Centered Difference for First Derivative</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-order-term">Zero-Order Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-implicit-scheme">Complete Implicit Scheme</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-form-of-the-implicit-scheme">Matrix Form of the Implicit Scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficient-values">Coefficient Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-equation">Matrix Equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions-on-finite-domain">Boundary Conditions on Finite Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#truncated-domain">Truncated Domain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-values">Boundary Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interior-and-boundary-schemes">Interior and Boundary Schemes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-the-left-boundary-i-m-1">Handling the Left Boundary (<span class="math notranslate nohighlight">\(i = -M+1\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-the-right-boundary-i-m-1">Handling the Right Boundary (<span class="math notranslate nohighlight">\(i = M-1\)</span>)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recapitulation-complete-system">Recapitulation: Complete System</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-structure">Matrix Structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#right-hand-side-vector">Right-Hand Side Vector</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-guidelines">Implementation Guidelines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-algorithm">Complete Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tridiagonal-system-solver-in-matlab">Tridiagonal System Solver in MATLAB</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Agnès Tourin
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>